---
title: "bikedata"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
library(ggplot2)
```

```{r}
tripdata = read.csv("G:/Analytics/BayAreaBikeShare_Analysis/201402_trip_data.csv")
weath_data = read.csv("G:/Analytics/BayAreaBikeShare_Analysis/201402_weather_data.csv")

```
```{r}
#summary(tripdata)
str(tripdata)
```
```{r}
tripdata[1:5,]
```

```{r}
tripdata2 = data.frame(tripdata)
ggplot(tripdata2, aes(x = tripdata2$Subscription.Type)) + 
  geom_bar() 

```

```{r}
summary(tripdata2[2]$Start.Date)
```


```{r}
tripdata2 = data.frame(tripdata)
tripdata2$Start.Date <- strptime(tripdata$Start.Date, "%m/%d/%Y %H:%M")
tripdata2$Start.hour = strftime(tripdata2$Start.Date, '%H')
str(tripdata2[1,3])

strftime(tripdata2[1:10,3], '%H:%M')
```

```{r}
ggplot(tripdata2, aes(x = Start.hour)) + 
  geom_bar(aes(fill = Subscription.Type), position = 'dodge') 
  scale_x_date(date_labels = "%H")
```
```{r}
tripdata2$Day = strftime(tripdata2$Start.Date, '%d')

```
```{r}
ggplot(tripdata2,aes(x =as.Date(Start.Date), y = Duration/10)) +
  scale_y_log10() + scale_x_date(date_labels = '%b', date_breaks = '1 month') +
  geom_smooth( stat = 'summary', fun.y= mean) +
  geom_smooth(color = 'brown')
```

```{r}
tripdata2$Weekday = weekdays(tripdata2$Start.Date)
```
```{r}
data1 = data.frame(tripdata2)
data1$Weekday = factor(tripdata2$Weekday, levels= c("Monday", 
    "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data1, aes(x = Weekday)) + 
  geom_bar(aes(fill = Subscription.Type), position = 'dodge') 
```

```{r}
head(weath_data)
```

```{r}
weath_data2 = data.frame(weath_data)
weath_data2$Date = as.Date(weath_data$Date, '%m/%d/%Y')
ggplot(weath_data2, aes(x= Date)) + geom_line(aes(y = Min_TemperatureF)) +
  geom_smooth(aes(y = Min_TemperatureF), color = 'blue', span = 0.2) +
  scale_x_date(date_labels = "%B", date_breaks = '1 month')
```
```{r}
tripdata2$Duration.min = tripdata2$Duration/60.0
ggplot(tripdata2, aes(x= Duration.min, width=5, fill = Subscription.Type)) + 
  geom_bar( position = 'dodge',  color = 'Red') +
  scale_y_continuous(breaks = seq(0,50000,5000)) +
  scale_x_continuous(breaks = seq(0,5,50))+
  xlim(0,50)#
  coord_cartesian()
 # geom_smooth(aes(y = Precipitation_In), color = 'blue', span = 0.2) +
  #scale_x_date(date_labels = "%B", date_breaks = '1 month')
```


# Ggplot2 library
library(ggplot2)

# Use the mtcars dataset.
head(mtcars)

# Basic barplot:
ggplot(mtcars, aes(x=as.factor(cyl) )) + geom_bar()